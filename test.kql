resources
| where type =~ 'microsoft.storage/storageaccounts'
| where tags['backup'] != 'none'
| project storageId = tolower(id), storageName = name, resourceGroup, subscriptionId, location, backupTag = tags['backup']
| where storageId !in (
    resources
    | where type =~ 'microsoft.dataprotection/backupvaults/backupinstances'
    | extend dsInfo = properties.dataSourceInfo
    | where dsInfo.resourceType =~ 'Microsoft.Storage/storageAccounts'
    | project tolower(dsInfo.resourceID)
)
| project storageName, resourceGroup, subscriptionId, location, backupTag
